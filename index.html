<!DOCTYPE html>
<html lang="fr">

<head>
    <title>Editor</title>
    <meta charset="UTF-8">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="stylesheet" href="editor.css">
    <link rel="stylesheet" href="./ace-builds/css/theme/monokai.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="./scripts/utils.js" type='text/javascript'></script>
    <script src="./scripts/editor.js" type='text/javascript'></script>
    <script src="./scripts/parser.js" type='text/javascript'></script>
    <script src="./scripts/page_manager.js" type='text/javascript'></script>
    <script src="./scripts/save.js" type='text/javascript'></script>
    <script src="./scripts/stylist.js" type='text/javascript'></script>
    <script src="./styles/default.js" type='text/javascript'></script>
    <script src="./utils/popup.js" type='text/javascript'></script>

    <!-- Markdown -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/markdown-it/13.0.2/markdown-it.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/UmemotoCtrl/mdpjs@0.1.4/js/mdp.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mdbassit/Coloris@latest/dist/coloris.min.css"/>
    <script src="https://cdn.jsdelivr.net/gh/mdbassit/Coloris@latest/dist/coloris.min.js"></script>
</head>

<script type="text/javascript">
    function PrintDiv(id) {
        var data=document.getElementById('page-container').innerHTML;
        var myWindow = window.open('', 'Tales', 'fullscreen=1');
        myWindow.document.write('<html><head><title>Tales</title>');
        myWindow.document.write('<link rel="preconnect" href="https://fonts.googleapis.com">');
        myWindow.document.write('<link rel="stylesheet" href="editor.css" type="text/css" />');
        myWindow.document.write('</head>');
        myWindow.document.write(editor.style_css());
        myWindow.document.write('<body>');
        myWindow.document.write(data);
        myWindow.document.write('</body></html>');
        myWindow.document.close(); // necessary for IE >= 10

        myWindow.onload=function(){ // necessary if the div contain images
            myWindow.focus(); // necessary for IE >= 10
            myWindow.print();
            //myWindow.close();
        };
    }

    function toggle_visibility(id){
        let element = document.getElementById(id)
        console.log(element.style.visibility)
        if (element.style.visibility == "hidden") {
            element.style.visibility = "visible"
        } else {
            element.style.visibility = "hidden"
        }
    }

</script>

<div id="quick-style">
    
</div>

<body>
    <div id="options">
        <!-- Editor buttons -->
        <div class="button-container">
            <div class="widgets">
                <button title='Align Left' onclick="editor.insert('[left]', '[/left]')"><i class="fa-solid fa-align-left"></i></button>
                <button title='Align Center' onclick="editor.insert('[center]', '[/center]')"><i class="fa-solid fa-align-center"></i></button>
                <button title='Align Right' onclick="editor.insert('[right]', '[/right]')"><i class="fa-solid fa-align-right"></i></button>
                <button title='Align Justify' onclick="editor.insert('[justify]', '[/justify]')"><i class="fa-solid fa-align-justify"></i></button>
            </div>

            <div class="widgets">
                <button title='Heading' style="position: relative;">
                    <i class="fa-solid fa-heading"></i>
                    <div class="dropdown">
                        <div title="Page Title" onclick="editor.insert('# ')"><i class="bi bi-type-h1"></i> Page Title</div>
                        <div title="Section Title" onclick="editor.insert('## ')"><i class="bi bi-type-h2"></i> Section Title</div>
                        <div title="Subsection Title" onclick="editor.insert('### ')"><i class="bi bi-type-h3"></i> Subsection Title</div>
                        <div title="Subsubsection Title" onclick="editor.insert('#### ')"><i class="bi bi-type-h4"></i> Subsubsection Title</div>
                        <div title="Table Title" onclick="editor.insert('##### ')"><i class="bi bi-type-h5"></i> Table Title</div>
                    </div>
                </button>
                <button title='Bold' onclick="editor.insert_line('**', '**', '  \n\n')"><i class="fa-solid fa-bold"></i></button>
                <button title='Italic' onclick="editor.insert('_', '_')"><i class="fa-solid fa-italic"></i></button>
                <button title='Underline' onclick="editor.insert('[u]', '[/u]')"><i class="fa-solid fa-underline"></i></button>
            </div>
            
            <div class="widgets">
                <button title='Unordered List' onclick="editor.insert_line('- ')"><i class="fa-solid fa-list-ul"></i></button>
                <button title='Ordered List' onclick="editor.insert_line('{0}. ')"><i class="fa-solid fa-list-ol"></i></button>
            </div>

            
            <div class="widgets">
            	<button title="Table" onclick="editor.insert('##### Table Title\n| Column 1 | Column 2 |\n|----------|----------|\n| Value 1  | Value 2  |')"><i class="fa-solid fa-table"></i></button>
            	<button title="Image" onclick="editor.insert('[image link=\'\']')"><i class="fa-solid fa-image"></i></button>
            	<button title="Wide Block" onclick="editor.insert('[wide]', '[/wide]')"><img class="svg-icon" src='./icons/wide.svg'/></button>
			</div>

            
            <div class="widgets">
            	<button title="Column Break" onclick="editor.insert('[newcolumn]')"><img class="svg-icon" src='./icons/column-break2.svg'/></button>
            	<button title="Page Break" onclick="editor.insert('[newpage]')"><img class="svg-icon" src='./icons/page-break.svg'/></button>
            	<button title="Horizontal Space" onclick="editor.insert('[hspace 1em]')"><i class="bi bi-vr"></i></button>
            	<button title="Vertical Space" onclick="editor.insert('\n[vspace 1em]\n')"><i class="bi bi-hr"></i></button>
			</div>

            
            <div class="widgets">
            	<button title="Colors" onclick="toggle_visibility('color-picker-container')"><img class="svg-icon" src='./icons/palette.svg'/></button>
            	<button title="Theme" onclick=""><i class="bi bi-palette2"></i></button>
            	<button title="Apps" style="position: relative;">
                    <img class="svg-icon" src='./icons/snippets.svg'/>
                    
                    <div class="dropdown">
                        <div title="Background Image" onclick="editor.insert('[image link=\'', '\' absolute top=0 left=0]')"><i class="fa-solid fa-images"></i> Background Image</div>
                        <div title="Cover" onclick="editor.insert('[cover]\n\n# Title\n[separator diamond]\n\n[splootch]\n    HOMEBREW\n[/splootch]\n\n[nofooter]\n[/cover]')"><i class="fa-solid fa-book"></i> Cover Page</div>
                        <div title="Part" onclick="editor.insert('[part]\n\n# PART 1\n## Subtitle\n\n[nofooter]\n[/part]')"><i class="fa-solid fa-bookmark"></i> Part Page</div>
                        <div title="Note" onclick="editor.insert('[note]\n\n##### Note\n', '\n\n[/note]')"><i class="bi bi-sticky-fill"></i> Note</div>
                        <div title="Description" onclick="editor.insert('[description]\n\n##### Description', '\n\n[/description]')"><i class="bi bi-card-text"></i> Description</div>
                        <div title="Quote" onclick="editor.insert('[quote]\n\n', '\n\n- Author\n\n[/quote]')"><i class="bi bi-quote"></i> Quote</div>
                        <div title="Monster Stats" onclick="editor.insert('[monster]\n\n## Monster Name\n*Medium humanoid, any alignment*\n___\n**Armor Class** :: 10\n**Hit Points** :: 22 (5d8)\n**Speed** :: 30 ft.\n___\n|  STR  |  DEX  |  CON  |  INT  |  WIS  |  CHA  |\n|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|\n|10 (+0)|10 (+0)|10 (+0)|10 (+0)|10 (+0)|10 (+0)|\n___\n**Senses** :: passive Perception 10\n**Languages** :: â€”\n**Challenge** :: 1 (200 XP)\n___\n***Feature 1*** Description. [vspace]\n***Feature 2*** Description. \n\n### Actions\n***Action 1*** Description. [vspace]\n***Action 2*** Description. \n\n[/monster]')">
                            <i class="fa-solid fa-skull"></i> Monster Stats
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <div id="editor-container">
        
    </div>
</body>

<script src="ace-builds/src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    let editor = new BBEditor("editor-container")

    
    Coloris({
    el: '.coloris',
    swatches: [
        '#264653',
        '#2a9d8f',
        '#e9c46a',
        '#f4a261',
        '#e76f51',
        '#d62828',
        '#023e8a',
        '#0077b6',
        '#0096c7',
        '#00b4d8',
        '#48cae4'
    ]
    });

    /** Instances **/

    Coloris.setInstance('.color-selector', { 
        closeButton: true,
        closeLabel: 'Done',
    });
</script>

</html>